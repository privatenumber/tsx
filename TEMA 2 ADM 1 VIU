import React, { useState } from 'react';
import { Check, X } from 'lucide-react';

const Quiz = () => {
  const [answers, setAnswers] = useState({});
  const [showResults, setShowResults] = useState({});

  const questions = [
    {
      id: 1,
      question: "驴Qu茅 significa el principio de vinculaci贸n positiva aplicado a la Administraci贸n?",
      options: [
        "La Administraci贸n puede actuar libremente mientras no contradiga las normas",
        "La norma es un fundamento previo y necesario, solo se puede actuar si hay habilitaci贸n normativa",
        "La Administraci贸n puede dispensar a terceros del cumplimiento de reglamentos",
        "Las actuaciones administrativas no necesitan base legal en materias no reservadas"
      ],
      correct: 1
    },
    {
      id: 2,
      question: "Seg煤n el art. 103.1 CE, 驴a qu茅 debe someterse la Administraci贸n?",
      options: [
        "Solo a la Ley emanada del Parlamento",
        "A la Ley y a las normas reglamentarias propias",
        "Con sometimiento pleno a la Ley y al Derecho",
        "nicamente a la Constituci贸n"
      ],
      correct: 2
    },
    {
      id: 3,
      question: "驴Qu茅 supone el poder de autotutela declarativa de la Administraci贸n?",
      options: [
        "La necesidad de acudir a los Tribunales para ejecutar sus decisiones",
        "La potestad de emitir declaraciones que modifican situaciones jur铆dicas sin intervenci贸n judicial",
        "La obligaci贸n de contar con el consentimiento del destinatario",
        "El sometimiento a los particulares en la tutela de derechos"
      ],
      correct: 1
    },
    {
      id: 4,
      question: "El principio de inderogabilidad singular de los reglamentos implica que:",
      options: [
        "La Administraci贸n puede dictar actos singulares en contradicci贸n con sus reglamentos",
        "Las resoluciones administrativas particulares no pueden vulnerar disposiciones de car谩cter general",
        "Los reglamentos solo obligan a los administrados, no a la Administraci贸n",
        "La Administraci贸n puede dispensar libremente del cumplimiento de reglamentos"
      ],
      correct: 1
    },
    {
      id: 5,
      question: "驴Qu茅 art铆culo de la CE establece el control jurisdiccional de la potestad reglamentaria?",
      options: [
        "Art. 103.1 CE",
        "Art. 9.3 CE",
        "Art. 106.1 CE",
        "Art. 24.1 CE"
      ],
      correct: 2
    },
    {
      id: 6,
      question: "El principio de eficacia (art. 103.1 CE) implica:",
      options: [
        "Que la eficacia prevalece sobre el principio de legalidad",
        "Una actuaci贸n orientada al resultado y consecuci贸n de objetivos legales",
        "Que el control jurisdiccional puede juzgar la eficacia administrativa",
        "Que la Administraci贸n puede obviar normas por razones de eficacia"
      ],
      correct: 1
    },
    {
      id: 7,
      question: "El derecho a la tutela judicial efectiva (art. 24.1 CE) incluye principalmente:",
      options: [
        "Solo el derecho a recurrir decisiones judiciales",
        "nicamente el derecho a solicitar medidas cautelares",
        "El derecho a la acci贸n o proceso y a obtener una resoluci贸n sobre el fondo",
        "Exclusivamente el derecho a la ejecuci贸n de sentencias"
      ],
      correct: 2
    },
    {
      id: 8,
      question: "Seg煤n la CE, 驴qu茅 dos instituciones garantizan el patrimonio de los ciudadanos frente a la Administraci贸n?",
      options: [
        "Autotutela y tutela judicial",
        "Expropiaci贸n forzosa y responsabilidad patrimonial",
        "Legalidad y eficacia",
        "Imparcialidad y objetividad"
      ],
      correct: 1
    },
    {
      id: 9,
      question: "El art. 9.2 CE, que fundamenta el Estado Social, establece que los poderes p煤blicos deben:",
      options: [
        "nicamente garantizar la libertad individual",
        "Promover condiciones para que la libertad e igualdad sean reales y efectivas",
        "Abstenerse de intervenir en la sociedad",
        "Concentrarse solo en la prestaci贸n de servicios p煤blicos"
      ],
      correct: 1
    },
    {
      id: 10,
      question: "El car谩cter revisor del proceso contencioso-administrativo significa que:",
      options: [
        "El ciudadano puede solicitar declaraciones preventivas de sus derechos",
        "Los Tribunales pueden actuar antes que la Administraci贸n",
        "El recurrente debe esperar a que la Administraci贸n dicte su decisi贸n para poder recurrir",
        "La Administraci贸n puede revisar las sentencias judiciales"
      ],
      correct: 2
    },
    {
      id: 11,
      question: "Los criterios de objetividad e imparcialidad de la Administraci贸n (art. 103.1 CE) implican:",
      options: [
        "Que la Administraci贸n es un ap茅ndice del Gobierno sin autonom铆a",
        "Que la actividad debe ser fiel a los fines legales y ponderar todos los intereses en juego",
        "Que pueden otorgarse preferencias sin amparo normativo",
        "Que la ideolog铆a pol铆tica debe guiar las decisiones administrativas"
      ],
      correct: 1
    },
    {
      id: 12,
      question: "El derecho de acceso a archivos y registros administrativos (art. 105 CE) NO incluye:",
      options: [
        "Documentos sobre seguridad y defensa del Estado",
        "Informaci贸n sobre delitos o intimidad de personas",
        "Documentos de cualquier procedimiento administrativo",
        "Secretos comerciales o industriales"
      ],
      correct: 2
    },
    {
      id: 13,
      question: "Seg煤n el documento, 驴existe un principio constitucional general de participaci贸n administrativa?",
      options: [
        "S铆, establecido en el art. 103 CE con car谩cter general",
        "S铆, pero solo para los funcionarios p煤blicos",
        "No, solo se acepta en 谩mbitos organizativos o funcionales concretos",
        "S铆, aplicable a todos los procedimientos administrativos"
      ],
      correct: 2
    },
    {
      id: 14,
      question: "La autonom铆a territorial NO incluye:",
      options: [
        "Potestad normativa",
        "Potestad sancionadora",
        "Soberan铆a",
        "Potestad expropiatoria"
      ],
      correct: 2
    },
    {
      id: 15,
      question: "El principio de coordinaci贸n del Estado sobre las CCAA supone:",
      options: [
        "Una ablaci贸n de competencias del ente coordinado",
        "Una posici贸n de supremac铆a que permite establecer el procedimiento de ejercicio de competencias",
        "Poderes que se presumen sin necesidad de atribuci贸n expresa",
        "La eliminaci贸n de la autonom铆a de las CCAA"
      ],
      correct: 1
    },
    {
      id: 16,
      question: "El art. 139.2 CE sobre unidad de mercado proh铆be:",
      options: [
        "Cualquier medida auton贸mica que incida en la circulaci贸n",
        "Todas las medidas tributarias auton贸micas",
        "Las medidas que directa o indirectamente obstaculicen la libre circulaci贸n",
        "El establecimiento de personas en otras CCAA"
      ],
      correct: 2
    },
    {
      id: 17,
      question: "El principio de solidaridad (art. 2 CE) se traduce en:",
      options: [
        "Solo la cooperaci贸n bilateral entre CCAA",
        "El equilibrio econ贸mico interterritorial y la lealtad auton贸mica",
        "nicamente el Fondo de Compensaci贸n Interterritorial",
        "La eliminaci贸n de desigualdades mediante control estatal directo"
      ],
      correct: 1
    },
    {
      id: 18,
      question: "驴Qu茅 r茅gimen de vinculaci贸n rige para las actuaciones administrativas de eficacia ablatoria?",
      options: [
        "Vinculaci贸n negativa",
        "Vinculaci贸n positiva: necesitan autorizaci贸n legal previa",
        "No necesitan vinculaci贸n legal",
        "Solo vinculaci贸n reglamentaria"
      ],
      correct: 1
    },
    {
      id: 19,
      question: "El deber de lealtad auton贸mica (Bundestreue) implica:",
      options: [
        "Subordinaci贸n absoluta de las CCAA al Estado",
        "Comportarse con buena fe y lealtad al sistema auton贸mico y unitario",
        "Solo cooperaci贸n en materias econ贸micas",
        "Eliminaci贸n de competencias concurrentes"
      ],
      correct: 1
    },
    {
      id: 20,
      question: "Los instrumentos que la CE proporciona al Estado para lograr el equilibrio econ贸mico interterritorial son:",
      options: [
        "Solo la planificaci贸n econ贸mica",
        "Control directo de presupuestos auton贸micos y locales",
        "La planificaci贸n econ贸mica y el Fondo de Compensaci贸n Interterritorial",
        "nicamente medidas fiscales centralizadas"
      ],
      correct: 2
    }
  ];

  const handleAnswer = (questionId, optionIndex) => {
    setAnswers({...answers, [questionId]: optionIndex});
    setShowResults({...showResults, [questionId]: true});
  };

  const resetQuiz = () => {
    setAnswers({});
    setShowResults({});
  };

  const getScore = () => {
    let correct = 0;
    questions.forEach(q => {
      if (answers[q.id] === q.correct) correct++;
    });
    return correct;
  };

  const totalAnswered = Object.keys(answers).length;
  const score = getScore();

  return (
    <div className="max-w-4xl mx-auto p-6 bg-gray-50 min-h-screen">
      <div className="bg-white rounded-lg shadow-lg p-6 mb-6">
        <h1 className="text-3xl font-bold text-gray-800 mb-2">Quiz - Derecho Administrativo I</h1>
        <p className="text-gray-600 mb-4">Tema 2: Bases Constitucionales del Derecho Administrativo</p>
        
        <div className="flex gap-4 text-sm">
          <div className="bg-blue-100 px-4 py-2 rounded">
            <span className="font-semibold">Respondidas:</span> {totalAnswered}/20
          </div>
          <div className="bg-green-100 px-4 py-2 rounded">
            <span className="font-semibold">Correctas:</span> {score}/{totalAnswered}
          </div>
          {totalAnswered > 0 && (
            <button 
              onClick={resetQuiz}
              className="bg-red-500 text-white px-4 py-2 rounded hover:bg-red-600"
            >
              Reiniciar
            </button>
          )}
        </div>
      </div>

      {questions.map((q, qIndex) => (
        <div key={q.id} className="bg-white rounded-lg shadow-md p-6 mb-4">
          <h3 className="font-bold text-lg mb-4 text-gray-800">
            {qIndex + 1}. {q.question}
          </h3>
          
          <div className="space-y-2">
            {q.options.map((option, optIndex) => {
              const isSelected = answers[q.id] === optIndex;
              const isCorrect = optIndex === q.correct;
              const showFeedback = showResults[q.id];
              
              let buttonClass = "w-full text-left p-4 rounded-lg border-2 transition-all ";
              
              if (!showFeedback) {
                buttonClass += "border-gray-200 hover:border-blue-400 hover:bg-blue-50";
              } else if (isCorrect) {
                buttonClass += "border-green-500 bg-green-50";
              } else if (isSelected && !isCorrect) {
                buttonClass += "border-red-500 bg-red-50";
              } else {
                buttonClass += "border-gray-200 bg-gray-50";
              }
              
              return (
                <button
                  key={optIndex}
                  onClick={() => !showResults[q.id] && handleAnswer(q.id, optIndex)}
                  disabled={showResults[q.id]}
                  className={buttonClass}
                >
                  <div className="flex items-center justify-between">
                    <span className="flex items-center gap-3">
                      <span className="font-semibold text-gray-600">
                        {String.fromCharCode(65 + optIndex)})
                      </span>
                      <span>{option}</span>
                    </span>
                    
                    {showFeedback && isCorrect && (
                      <Check className="text-green-600 flex-shrink-0" size={24} />
                    )}
                    {showFeedback && isSelected && !isCorrect && (
                      <X className="text-red-600 flex-shrink-0" size={24} />
                    )}
                  </div>
                </button>
              );
            })}
          </div>
        </div>
      ))}

      {totalAnswered === 20 && (
        <div className="bg-white rounded-lg shadow-lg p-6 text-center">
          <h2 className="text-2xl font-bold mb-4">隆Quiz Completado!</h2>
          <p className="text-xl mb-2">
            Puntuaci贸n Final: <span className="font-bold text-blue-600">{score}/20</span>
          </p>
          <p className="text-lg text-gray-600">
            {score >= 18 ? "隆Excelente! " : 
             score >= 15 ? "隆Muy bien! " : 
             score >= 12 ? "Bien, pero puedes mejorar " : 
             "Necesitas repasar el tema "}
          </p>
        </div>
      )}
    </div>
  );
};

export default Quiz;
